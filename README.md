# Distribution-aware Diversification for Personalized Re-ranking in Recommendation

## Introduction
In  this  project, we aim to improve the recommendation diversity in the re-ranking stage, and propose a 
Distribution-aware Diversification for Personalized Re-ranking (DDPR). DDPR is featured with two distribution-aware designs: 

* Distribution-aware Diversity Module. 
  * The Distribution-aware Diversity Module introduces category distribution into the objective of the diversity optimization, increasing the number of categories in the list while making the distribution of categories more balanced.

* Distribution-aware Personalization Module. 
  * The Distribution-aware Personalization Module takes personalized diversification into account, innovatively enhancing personalized recommendations by approximating the distribution of the recommendation list to the user interaction history distribution.

## Prerequisites
- Python 3
- TensorFlow-GPU >= 1.8 (< 2.0)
- Faiss-GPU

## Get Started
We construct a recommendation system pipline that includes the matching stage, ranking stage, and re-ranking stage. The matching stage uses ComiRec, the ranking stage uses DRN, and the re-ranking stage uses MMR, DPP, CATE, PMF, SSD, RLprop. The matching model (ComiRec) generates candidate items for the ranking model. Ranking model ranks all candidate items generated from the matching stage. The re-ranking model re-ranks the list generated by the DRN model.
### Dataset
Original links of datasets are:
- https://tianchi.aliyun.com/dataset/649
- https://grouplens.org/datasets/movielens/1m/
### Matching model

- For dataset, you can use `python matching_model/preprocess/data.py {dataset_name}` to generate a specific dataset for the matching model ComiRec training.
- For training, you can use `python matching_model/train.py --dataset {dataset_name} --model_type {model__name}` to train the ComiRec model.

### Ranking model
- For dataset, you can use `python ranking_model/preprocess/{dataset_name}_data_gen.py` to generate a specific dataset for the Ranking Model training.
- For training, you can use `python ranking_model/train.py {dataset_name} {model_name} ...parameters` to train any ranking model you want.

### Re-ranking model
- For mmr based and dpp based re-ranking models, you can set the model mode to `test` and use `python train.py` to run the re-ranking model for testing.
- For Deep Learning based re-ranking models, you can use `python DL_based_reranking_model/train.py` to train and test the DL based re-ranking models.
