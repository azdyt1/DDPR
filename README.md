# Distribution-aware Diversification for Personalized Re-ranking in Recommendation

## Introduction
In  this  project, we aim to improve the recommendation diversity in the ranking stage, and propose a 
Diversity-aware Deep Ranking Network(DDRN). DDRN is featured with two diversity-aware designs: 

* Diversity-aware Listwise Information Fusion. 
  * The Diversity-aware Listwise Information Fusion captures the listwise information of the recommendation list and generates a diverse embedding for each target item, which helps seperate similar items and optimize the diversity distribution of the whole list.

* Balanced Weighting Loss. 
  * The Balanced Weighting Loss design eliminate bias between user interaction categories by a balanced weighting loss which balance the gradients between user interaction categories.

## Prerequisites
- Python 3
- TensorFlow-GPU >= 1.8 (< 2.0)
- Faiss-GPU

## Get Started
We construct a recommendation system pipline that includes the matching stage, ranking stage, and re-ranking stage. The matching stage uses ComiRec, the ranking stage uses DDRN, DRN, SIM, MMOE, and the re-ranking stage uses MMR, DPP, CATE, and DUM. The matching model (ComiRec) generates candidate items for the ranking model. Ranking model ranks all candidate items generated from the matching stage. The re-ranking model re-ranks the list generated by the DRN model.
### Dataset
Original links of datasets are:
- https://tianchi.aliyun.com/dataset/649
- https://grouplens.org/datasets/movielens/1m/
### Matching model

- For dataset, you can use `python matching_model/preprocess/data.py {dataset_name}` to generate a specific dataset for the matching model ComiRec training.
- For training, you can use `python matching_model/train.py --dataset {dataset_name} --model_type {model__name}` to train the ComiRec model.

### Ranking model
- For dataset, you can use `python ranking_model/preprocess/{dataset_name}_data_gen.py` to generate a specific dataset for the Ranking Model training.
- For training, you can use `python ranking_model/train.py {dataset_name} {model_name} ...parameters` to train any ranking model you want.

### Re-ranking model
- For re-ranking model, you can use `python ranking_model/test_rerank.py` to run the re-ranking model for testing.
